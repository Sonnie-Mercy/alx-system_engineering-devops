#!/usr/bin/env bash
# This script configures Nginx to run as the nginx user and listen on port 8080.
sudo sed -i 's/user .*/user nginx;/g' /etc/nginx/nginx.conf
sudo sed -i 's/listen .*/listen 8080;/g' /etc/nginx/sites-available/default

# Check if the configuration is okay
sudo nginx -t
if [ $? -ne 0 ]
then
  echo "Nginx configuration test failed"
  exit 1
fi

# If the configuration test is successful, reload Nginx
sudo service nginx reload
if [ $? -eq 0 ]
then
  echo "Nginx has been reloaded and is now running as the nginx user and listening on port 8080"
else
  echo "Failed to reload Nginx"
fi
